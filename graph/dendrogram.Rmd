---
myimage: "DendrogramSmall.png"
mydisqus: "dendrogram"
mytitle: "Dendrogram"
output:
  html_document:
      self_contained: false    
      mathjax: default
      lib_dir: libs
      template: template_datatoviz.html
      theme: "lumen"
      css: style.css
      toc: FALSE
      toc_float: TRUE
      toc_depth: 2
      number_sections: TRUE
      df_print: "paged"
      code_folding: "hide"
      includes: 
        after_body: footer.html
---


<div class="mycontent">




# Definition {#definition}
***

A dendrogram is a `network structure`. It is constituted of a `root node` that gives birth to several `nodes` connected by `edges` or `branches`. The last nodes of the hierarchy are called `leaves`. In the following example, the CEO is the root node. He manages 2 managers that manage 8 employees (the leaves).


```{r, warning=FALSE, message=FALSE, fig.align="center", fig.height=4}
# libraries
library(ggraph)
library(igraph)
library(tidyverse)

# create a data frame 
data=data.frame(
  level1="CEO",
  level2=c( rep("boss1",4), rep("boss2",4)),
  level3=paste0("mister_", letters[1:8])
)
 
# transform it to a edge list!
edges_level1_2 = data %>% select(level1, level2) %>% unique %>% rename(from=level1, to=level2)
edges_level2_3 = data %>% select(level2, level3) %>% unique %>% rename(from=level2, to=level3)
edge_list=rbind(edges_level1_2, edges_level2_3)
 
# Now we can plot that
mygraph <- graph_from_data_frame( edge_list )
ggraph(mygraph, layout = 'dendrogram', circular = FALSE) + 
  geom_edge_diagonal() +
  geom_node_point(color="#69b3a2", size=3) +
  geom_node_text(
    aes(  label=c("CEO", "Manager", "Manager", LETTERS[8:1]) ), 
    hjust=c(1,0.5, 0.5, rep(0,8)), 
    nudge_y = c(-.02, 0, 0, rep(.02,8)),
    nudge_x = c(0, .3, .3, rep(0,8))
  ) +
  theme_void() +
  coord_flip() +
  scale_y_reverse() 
```

<br>

Two type of dendrogram exist, resulting from 2 types of dataset: 

- A `hierarchic` dataset provides the links between nodes explicitely. Like above.
- The result of a `clustering` algorythm can be visualized as a dendrogram.


```{r, warning=FALSE, message=FALSE, fig.align="center", fig.height=6, fig.width=6}
# Load the data
data <- read.table("/Users/y.holtz/Dropbox/data_to_viz/Example_dataset/13_AdjacencyUndirecterWeighted.csv", header=T, row.names="Cities.", sep=",") %>% as.matrix
colnames(data) <- gsub("\\.", " ", colnames(data))
is.matrix(data)
data
```











# What for
***

Circle packing is not recommended if you need to precisely compare values of group. Indeed, it is hard for the human eye to [translate an area into an accurate number](https://www.data-to-viz.com/caveat/bubble_hard.html). If you need accuracy, use a [barplot](https://www.data-to-viz.com/graph/barplot.html) or a [lollipop](https://www.data-to-viz.com/graph/lollipop.html) plot instead.  

However, circular packing shows very well how groups are organised in subgroups. It uses the space a bit less efficiently than a [treemap](https://www.data-to-viz.com/graph/treemap.html), but the hierarchy gets very neat.




# Variation {#variation}
***

When using circular packing I really like to remove the first or two first levels of the hierarchy on the plot. I believe it improves the appearance of the graphic but this is purely an aesthetic point of view:

```{r, warning=FALSE, message=FALSE, fig.align="center", fig.height=6, fig.width=6}
# Libraries
library(ggraph)
library(igraph)
library(viridis)
 
# We need a data frame giving a hierarchical structure. Let's consider the flare dataset:
edges=flare$edges
vertices = flare$vertices
mygraph <- graph_from_data_frame( edges, vertices=vertices )
 
# Second one: add 2 first levels
ggraph(mygraph, layout = 'circlepack', weight="size") + 
  geom_node_circle(aes(fill = as.factor(depth), color = as.factor(depth) )) +
  scale_fill_manual(values=c("0" = "white", "1" = "white", "2" = magma(4)[2], "3" = magma(4)[3], "4"=magma(4)[4])) +
  scale_color_manual( values=c("0" = "white", "1" = "white", "2" = "black", "3" = "black", "4"="black") ) +
  theme_void() + 
  theme(legend.position="FALSE")
```

Note that if only one level of hierarchy is displayed (no encapsulation), it becomes equivalent to a barplot. Instead of showing the value of each individual as a bar, it uses a circle.


# Common mistakes {#mistake}
***

- If many levels in the hierarchy, using an interactive version is advised. Indeed adding to many labels could make the graphic unreadable.

# Related {#related}
***

<div class="row">
  <div class="col-lg-3 col-md-6 col-sm-6">
  <a href="http://www.data-to-viz.com/graph/barplot.html" class="btn btn-primary mybtnrelated" style="margin-bottom:4px;white-space: normal !important;">
  <img  src="https://github.com/holtzy/data_to_viz/raw/master/img/section/BarSmall.png">
  <p class="mytitlerelated">Barplot</p>
  <p class="mytextrelated">Represents the value of entities using bar of various length.</p>
  </a>
  </div>
  <div class="col-lg-3 col-md-6 col-sm-6">
  <a href="http://www.data-to-viz.com/graph/lollipop.html" class="btn btn-primary mybtnrelated" style="margin-bottom:4px;white-space: normal !important;">
  <img  src="https://github.com/holtzy/data_to_viz/raw/master/img/section/LollipopSmall.png">
  <p class="mytitlerelated">Lollipop plot</p>
  <p class="mytextrelated">A fancy barplot where bars are replaced with a dot and a segment. Allows even more options when it comes to stacking.</p>
  </a>
  </div>
  <div class="col-lg-3 col-md-6 col-sm-6">
  <a href="http://www.data-to-viz.com/graph/treemap.html" class="btn btn-primary mybtnrelated" style="margin-bottom:4px;white-space: normal !important;">
  <img  src="https://github.com/holtzy/data_to_viz/raw/master/img/section/TreeSmall.png">
  <p class="mytitlerelated">Treemap</p>
  <p class="mytextrelated">Displays hierarchical data as a set of nested rectangles. Perfect to show how the whole is divided.</p>
  </a>
  </div>
  <div class="col-lg-3 col-md-6 col-sm-6">
  <a href="http://www.data-to-viz.com/graph/dendrogram.html" class="btn btn-primary mybtnrelated" style="margin-bottom:4px;white-space: normal !important;">
  <img  src="https://github.com/holtzy/data_to_viz/raw/master/img/section/DendrogramSmall.png">
  <p class="mytitlerelated">Dendrogram</p>
  <p class="mytextrelated">A network structure used to show a hierarchical organization.</p>
  </a>
  </div>
</div>



# Build your own {#code}
***

The [R](https://www.r-graph-gallery.com) and [Python](https://www.python-graph-gallery.com) graph galleries are 2 websites providing hundreds of chart example, always providing the reproducible code. Click the button below to see how to build the chart you need with your favorite programing language.

<p>
<a href="https://www.r-graph-gallery.com/circle-packing/" class="btn btn-primary">R graph gallery</a>
</p>



#Comments
***
Any thoughts on this? Found any mistake? Disagree? Please drop me a word on [twitter](https://twitter.com/R_Graph_Gallery) or in the comment section below:
<br>



</div>














